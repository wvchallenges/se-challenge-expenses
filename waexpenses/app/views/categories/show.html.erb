<p id="notice"><%= notice %></p>

<p>
  <strong>Name:</strong>
  <%= @category.name %>
</p>

<p>
  <strong>Description:</strong>
  <%= @category.description %>
</p>

<% if @category.parent %>
  <p>
    <strong>Parent category:</strong>
    <%= link_to(@category.parent) do %>
      <%= @category.parent.full_name %>
    <% end %>
  </p>
<% end %>

<p>
  <strong>Total expense:</strong>  <%= number_to_currency(@category.expense_total()) %>
</p>
<!-- partial for child expenses -->
<% if @category.children.count > 0 %>
  <p>
    <strong>Total expense including child categories:</strong>  <%= number_to_currency(@category.expense_total_including_children()) %>
  </p>

  <p>
    <strong>Children:</strong>
  </p>

  <% @category.children.each do |child| %>
    <p>
        <%= link_to(child) do %>
          <%= child.name %>
        <% end %>
    </p>
  <% end %>
<% end %>

<% if @category.expenses.count > 0 %>
  <div>
    <h2><%= @category.full_name %> Expenses</h2>

    <!-- partial, somehow -->
    <table>
      <thead>
        <tr>
          <th>Date</th>
          <th>Employee</th>
          <th>Expense Description</th>
          <th>Pre-Tax Amount</th>
          <th>Taxes/th>
          <th>Taxes Levied</th>
          <th>Total</th>
        </tr>
      </thead>
      <tbody>
        <% @category.expenses.each do |expense| %>
          <tr>
            <td><%= expense.date %></td>
            <td>
              <%= link_to(expense.employee) do %>
                <%= expense.employee.name %>
              <% end %>
            </td>
            <td>
              <%= link_to(expense) do %>
                <%= expense.description %>
              <% end %>
            </td>
            <td><%= number_to_currency(expense.amount) %></td>
            <td>
              <!-- do as join, map -->
              <%= render partial: "taxes/tax_list", locals: {taxes: expense.taxes} %>
            </td>
            <td><%= number_to_currency(expense.calculate_total_tax_amount()) %></td>
            <td><%= number_to_currency(expense.calculate_total_amount()) %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
<% end %>

<%= link_to 'Edit', edit_category_path(@category) %> |
<%= link_to 'All Categories', categories_path %>
