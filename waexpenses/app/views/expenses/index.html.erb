<h1>Wave SE Challenge</h1>

<div>
<h3>Import a CSV File</h3>
  <%= form_tag({action: :import}, multipart: true) do %>
    <%= file_field_tag :file %>
    <%= submit_tag "Import CSV" %>
  <% end %>
<%= flash[:notice] %>
</div>

<div>
  <h2>Monthly Expenses</h2>
  <table>
    <thead>
      <tr>
        <th>Month</th>
        <th>Total Expenses</th>
      </tr>
    </thead>
    <tbody>
      <% (0..@dates.length-1).each do |i| %>
        <tr>
          <td><%= @dates[i] %></td>
          <td><%= number_to_currency(@total_expense[i]) %></td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>


<div>
  <h2>All Expenses</h2>
  <table>
    <thead>
      <tr>
        <th>Date</th>
        <th>Category</th>
        <th>Employee Name</th>
        <th>Employee Address</th>
        <th>Expense Description</th>
        <th>Pre-Tax Amount</th>
        <th>Tax Name</th>
        <th>Tax Amount</th>
      </tr>
    </thead>
    <tbody>
      <% @expenses.each do |expense| %>
        <tr>
          <td><%= expense.date %></td>
          <td><%= expense.category.full_name %></td>
          <td>
            <%= link_to(expense.employee) do %>
              <%= expense.employee.name %>
            <% end %>
          </td>
          <td><%= expense.employee.address %></td>
          <td>
            <%= link_to(expense) do %>
              <%= expense.description %>
            <% end %>
          </td>
          <td><%= number_to_currency(expense.amount) %></td>
          <td><%= expense.taxes[0].name %></td>
          <td><%= number_to_currency(expense.tax_amounts[0].amount) %></td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>