<div>
<h3>Import a CSV File</h3>
  <%= form_tag({action: :import}, multipart: true) do %>
    <%= file_field_tag :file %>
    <%= submit_tag "Import CSV" %>
  <% end %>
<%= flash[:notice] %>
</div>

<div>
  <%= render partial: "expenses/total_by_month", locals: {dates_and_totals: @dates_and_totals} %>
</div>

<div>
  <h2>All Expenses</h2>
  <table class="expense_data">
    <thead>
      <tr>
        <th>Date</th>
        <th>Category</th>
        <th>Employee</th>
        <th>Description</th>
        <th>Pre-Tax Amount</th>
        <th>Tax Name</th>
        <th>Tax levied</th>
        <th>Total</th>
      </tr>
    </thead>
    <tbody>
      <% @expenses.each do |expense| %>
        <tr>
          <td><%= expense.date %></td>
          <td><%= link_to expense.category.full_name, expense.category %></td>
          <td><%= link_to expense.employee.name, expense.employee %></td>
          <td><%= link_to expense.description, expense %></td>
          <td class="numerical"><%= number_to_currency(expense.amount) %></td>
          <td>
            <%= render partial: "taxes/tax_list", locals: {taxes: expense.taxes} %>
          </td>
          <td class="numerical"><%= number_to_currency(expense.calculate_total_tax_amount()) %></td>
          <td class="numerical"><%= number_to_currency(expense.calculate_total_amount()) %></td>
        </tr>
      <% end %>
    </tbody>
  </table>
</div>